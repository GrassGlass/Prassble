%% The LaTeX project Prassble
%% preamble.tex: the preamble of Prassble
%%
%% -------------------------------------------------------------------------------------------
%% Copyright (c) 2025 by Grass (GrassGlass) <shaohong00002 at gmail dot com>
%% -------------------------------------------------------------------------------------------
%%
%% This work may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either version 1.3
%% of this license or (at your option) any later version.
%% The latest version of this license is in
%%   http://www.latex-project.org/lppl.txt
%% and version 1.3 or later is part of all distributions of LaTeX
%% version 2005/12/01 or later.
%%
%% This work has the LPPL maintenance status `author-maintained'.
%%
%% This work consists of all files listed in README
%%
% Preamble
% We split the package loading and package option setting, because it's not a good idea to mix them, apparently: https://tex.stackexchange.com/a/745011/383565

% Packages
  % Encodings
  \usepackage[utf8]{inputenc}
  \usepackage[T1]{fontenc}
  % Language
  \usepackage[UKenglish]{babel} 
  % % Indentation
  %   % See posts: https://tex.stackexchange.com/a/39232/383565 and https://tex.stackexchange.com/a/39228/383565
  %   \usepackage{indentfirst}

  % Named colors
  \PassOptionsToPackage{dvipsnames, table}{xcolor} 
    % The table option of xcolor loads the colortbl package, in order to use the tools for coloring rows, columns, and cells within tables.

  % Tables
  \usepackage{array, booktabs, multirow, cellspace}

  % Figures
  \usepackage{graphicx}
  \graphicspath{{\CurrentFilePath/../figures/}} 
  \usepackage{caption, subcaption, float}

  % Math stuff
  \usepackage{amssymb, mathrsfs}
  \usepackage{mathtools, mleftright, nicematrix}
  \usepackage{intexgral}
    % prerequisites for \hatt command and \reallywidehat
    \usepackage{scalerel, stackengine}
    \usepackage{verbatimbox} % For \addvbuffer

  % Diagrams
  \usepackage{tikz}
  \usetikzlibrary{cd}

  % enumeration
  \usepackage[shortlabels,inline]{enumitem}
  \usepackage{eqparbox}

  % Margins and line spacing
  \usepackage[margin = 1.25in]{geometry}
  \geometry{
    bottom=15mm}
  \usepackage{setspaceenhanced, parskip}
  \onehalfspacing

  % Colored boxes
  \usepackage[skins, breakable, minted]{tcolorbox}
  \usepackage{keytheorems}
  \setminted{%
    ,escapeinside = ⵌⵌ
    % The characters afterwhich a linebreak can occur:
      % The backslashes are there only to escape the square brackets; the symbols "[" and "]" are the ones afterwhich a linebreak can occur. The \[\] is not indicating display mathmode.
      ,breakafter = \[\]()
  }

  % Page formatting
  \usepackage[pagestyles]{titlesec}
  \usepackage{lmodern, microtype}

  % Refer
  \usepackage{soul} % for special underlining of hyperlinks --- descenders are omitted
  \PassOptionsToPackage{hyphens}{url}
  \usepackage{hyperref}
  \usepackage{zref-titleref}
  \usepackage{zref-clever}
  \hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    }

% Custom setup

  % Easy input of multiple files; \Input is \input but with the file path taken relative to
    % 1. the directory preamble, if \Input is used before \begin{document}
    % 2. the parent directory of the folder preamble (which in this case is the directory Prassble), if \Input is used after \begin{document}
  \ExplSyntaxOn
  \clist_new:N \l__preamble_files_to_be_input_clist
  \tl_new:N \g_file_directory_to_be_used_tl
  \tl_new:N \g_preamble_path_to_preamble_tl
  \tl_new:N \l__preamble_relative_path_to_prepend_tl
  \tl_gset:Ne \g_preamble_path_to_preamble_tl {\CurrentFilePath}
  \tl_set_eq:NN \g_file_directory_to_be_used_tl \g_preamble_path_to_preamble_tl
  \AtEndPreamble{\tl_gset:Ne \g_file_directory_to_be_used_tl {\g_preamble_path_to_preamble_tl/../}}
  \NewDocumentCommand{\Input}{ O{} m }{
    \tl_set:Nn \l__preamble_relative_path_to_prepend_tl {#1}
    \clist_set:Nn \l__preamble_files_to_be_input_clist {#2} 
    \clist_map_inline:Nn \l__preamble_files_to_be_input_clist {\input{\g_file_directory_to_be_used_tl/\l__preamble_relative_path_to_prepend_tl/##1}}
  }
  \ExplSyntaxOff
  
  % Math stuff
  \Input[math]{
    ,general_math.tex
    ,specific_math.tex
    }
  
  % enumeration
  \Input{enumeration.tex}

  % Other
  \Input{other.tex}

  % Custom symbols (\eeveeKawaii, \TikZ, etc)
  \Input{custom-symbols.tex}
  
  % Colored boxes
  \Input[environments/box_styles/listings/commands/newcommands]{%
    ,all_short_names.tex%
    ,new_variables.tex%
    ,name_converters.tex%
  }
  \Input[environments/box_styles]{
    ,listings/codestyles.tex%
    ,nonlistings.tex%
    ,lengths_and_counters.tex%
  }
  \Input[environments/box_styles/listings/commands/modified_commands]{%
    ,NewInputListing.tex%
    ,NewListing.tex%
  }
  \Input[environments/derived_environments]{
    ,listings.tex%
    ,nonlistings.tex%
    ,lengths.tex%
  }

  % page formatting
  \definecolor{HeaderColor}{RGB}{0,82,155} 
  \author{Author}
  \def\CourseName{\textlangle Course Name\textrangle}
  \newcounter{HWNumber}
  \Input{page-formatting.tex}

  % Refer
  \Input{external_hyperlink_format.tex}