%% The LaTeX project Prassble
%% preamble.tex: the preamble of Prassble
%%
%% -------------------------------------------------------------------------------------------
%% Copyright (c) 2025 by Grass (GrassGlass) <shaohong00002 at gmail dot com>
%% -------------------------------------------------------------------------------------------
%%
%% This work may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either version 1.3
%% of this license or (at your option) any later version.
%% The latest version of this license is in
%%   http://www.latex-project.org/lppl.txt
%% and version 1.3 or later is part of all distributions of LaTeX
%% version 2005/12/01 or later.
%%
%% This work has the LPPL maintenance status `author-maintained'.
%%
%% This work consists of all files listed in README
%%
% Preamble
% We split the package loading and package option setting, because it's not a good idea to mix them, apparently: https://tex.stackexchange.com/a/745011/383565

% Packages
  % Encodings
  \usepackage[utf8]{inputenc}
  \usepackage[T1]{fontenc}
  % Language
  \usepackage[UKenglish]{babel} 
  % % Indentation
  %   % See posts: https://tex.stackexchange.com/a/39232/383565 and https://tex.stackexchange.com/a/39228/383565
  %   \usepackage{indentfirst}

  % Named colors
  \PassOptionsToPackage{dvipsnames}{xcolor}

  % Tables
    % % Set-up 1: LaTeX2e tabular-style tables
    % \usepackage{array, booktabs, multirow, cellspace}
    % \PassOptionsToPackage{table}{xcolor} % loads the colortbl package

    % Set-up 2 (recommended): LaTeX3 tabularray tables
    \usepackage{tabularray}
    \UseTblrLibrary{booktabs, zref}
      % Other useful tabularray libraries: 
        % amsmath: matrix, cases, and array environments with tabularray key=value options
        % diagbox: diagonal cells
        % siunitx: siunitx package loading + compatibility with tabularray

  % Figures
  \usepackage{graphicx}
  \ExplSyntaxOn
    \graphicspath{{\g_Prassble_path_to_Prassble_folder_tl/figures/}} 
  \ExplSyntaxOff
  \usepackage{caption, subcaption, float}

  % Math stuff
  \usepackage{amssymb, mathrsfs}
  \usepackage{mathtools, mleftright, nicematrix}
  \usepackage{intexgral}
    % prerequisites for \hatt command
    \usepackage{stackengine}
    \usepackage{verbatimbox} % For \addvbuffer

  % % Sciences
  % Add siunitx to \UseTblrLibrary{ <clist of libraries> } in the "Tables/Set-up 2" section of this file (preamble.tex)
  % For Chemical structure diagrams, check out the METAPOST package mcf2graph https://ctan.org/pkg/mcf2graph or the LaTeX package chemfig https://ctan.org/pkg/chemfig?lang=en

  % Diagrams
  \usepackage{tikz, pgfplots}
  \usetikzlibrary{cd}
  \pgfplotsset{compat=1.18}
  % \usepackage{asymptote}

  % enumeration
  \usepackage[shortlabels,inline]{enumitem}
  \usepackage{eqparbox}

  % Margins and line spacing
  \usepackage[margin = 1.25in]{geometry}
  \geometry{
    bottom=15mm}
  \usepackage{setspaceenhanced, parskip}
  \onehalfspacing

  % Page formatting
  \usepackage[pagestyles]{titlesec}
  \usepackage{lmodern, microtype}
    % default color theme
    \ifundef{\ColorTheme}{
      \gdef\ColorTheme{colourful}
    }{}
    % 'documentation' page style -> use 'main' page style with some extra options (detected by defining \PrassbleDocumentationStyle)
    \ifdefstring{\Pagestyle}{documentation}{
      \gdef\Pagestyle{main}
      \gdef\PrassbleDocumentationStyle{}
    }{}

  % Colored boxes
  \usepackage[skins, breakable, minted]{tcolorbox}
  \ifdef{\PrassbleDocumentationStyle}{
    \tcbuselibrary{documentation}
    \tcbset{listing engine=minted}
  }{}
    % Required for autowidth = lower 
    \usepackage{varwidth}
  \setminted{%
    ,escapeinside = ⵌⵌ
    % The characters afterwhich a linebreak can occur:
      % The backslashes are there only to escape the square brackets; the symbols "[" and "]" are the ones afterwhich a linebreak can occur. The \[\] is not indicating display mathmode.
      ,breakafter = \[\]()
  }
  \usepackage{keytheorems}

  % Externalisation 
  % \usepackage{robust-externalize}

  % Refer
  \PassOptionsToPackage{hyphens}{url}
  \usepackage{hyperref}
  \usepackage{zref-titleref}
  \usepackage{zref-clever}
  \usepackage{zref-xr}

% Custom setup

  % Easy input of files
  \input{\CurrentFilePath/commands/modified_commands/Input_macro.tex}
  \Input{commands/modified_commands/Chapter_and_Section.tex}
  \Input{commands/newcommands/KeywordForInput.tex}
  \KeywordForInput{HW}{files/homework}                %*
  \KeywordForInput{Ch}{files/chapters}                %*
  
  % Math stuff
  \Input[math]{%
    ,general_math.tex%
    ,specific_math.tex%
    }
  
  % enumeration
  \Input{enumeration.tex}

  % Custom symbols (\eeveeKawaii, \TikZ, etc)
  \Input{custom-symbols.tex}
  
  % page formatting
  \definecolor{HeaderColor}{RGB}{0,82,155}            %*
  \author{Author}                                     %*
  \def\CourseName{\textlangle Course Name\textrangle} %*
  \newcounter{HWNumber}                               %*
  \Input{page-formatting.tex}
  \Input{hw_zexternaldocument_main.tex}
  \AddToHWEnvList{table,figure}                       %*

  % Colored boxes
    % Nonlistings
    \Input[environments/box_styles/nonlistings]{%
      ,theoremstyles.tex%
      ,commands/modified_commands/newkeytheorem.tex
      ,../lengths_and_counters.tex%
    }
    \Input[environments/derived_environments]{%
      ,lengths.tex%
      ,nonlistings.tex%
    }
    % Listings
    \Input[environments/box_styles/listings/commands/newcommands]{%
      ,all_short_names.tex%
      ,new_variables.tex%
      ,name_converters.tex%
    }
    \Input[environments/box_styles/listings/commands/modified_commands]{%
      ,../../codestyles.tex%
      ,NewInputListing.tex%
      ,NewListing.tex%
    }
    \Input{environments/derived_environments/listings.tex}
    \Input{environments/box_styles/nonlistings/commands/newcommands/InputKeyword_HW-in-Main.tex}

  % Refer
  \Input{external_hyperlink_format.tex}
  \hypersetup{
    ,colorlinks=true
    ,linkcolor=blue
    ,filecolor=magenta
    ,urlcolor=blue
    }

  % Other
  \Input{other.tex}
  \newcommand{\HWInMainHeader}{\subsection{Homework \#\arabic{HWNumber}}}                                        %*