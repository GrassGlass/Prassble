%% The LaTeX project Prassble
%% NewListing.tex: code for custom tcolorbox minted boxes
%%
%% -------------------------------------------------------------------------------------------
%% Copyright (c) 2025 by Grass (GrassGlass) <shaohong00002 at gmail dot com>
%% -------------------------------------------------------------------------------------------
%%
%% This work may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either version 1.3
%% of this license or (at your option) any later version.
%% The latest version of this license is in
%%   http://www.latex-project.org/lppl.txt
%% and version 1.3 or later is part of all distributions of LaTeX
%% version 2005/12/01 or later.
%%
%% This work has the LPPL maintenance status `author-maintained'.
%%
%% This work consists of all files listed in README
%%
\makeatletter
\ExplSyntaxOn
  \NewDocumentCommand{\ModifiedNewTCBListing}{ m m m }{
    \NewTCBListing{ #1 }{ #2 }{ #3 }
    \BeforeBeginEnvironment{#1}{
      % Before the listing
        % The value of \linewidth where the corresponding listing environment is located
          % The name is \linewidth*outside* precisely because its the \linewidth (immediately) outside the listing environment
          \dim_set:Nn \g__Prassble_listings_autowidth@core_max_tcb_width_dim {\the\linewidth}%
        % Centering the listing
        \par%
        \begingroup%=====%
          \centering%
    }
    \AfterEndEnvironment{#1}{
      % After the listing
          \__Prassble_listings_debug_autowidth:
          \stepcounter{code}%
        \endgroup%=====%
    }
  }
\ExplSyntaxOff
\makeatother