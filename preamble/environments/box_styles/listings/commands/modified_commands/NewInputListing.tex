%% The LaTeX project Prassble
%% NewInputListing.tex: code for custom tcolorbox minted input boxes
%%
%% -------------------------------------------------------------------------------------------
%% Copyright (c) 2025 by Grass (GrassGlass) <shaohong00002 at gmail dot com>
%% -------------------------------------------------------------------------------------------
%%
%% This work may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either version 1.3
%% of this license or (at your option) any later version.
%% The latest version of this license is in
%%   http://www.latex-project.org/lppl.txt
%% and version 1.3 or later is part of all distributions of LaTeX
%% version 2005/12/01 or later.
%%
%% This work has the LPPL maintenance status `author-maintained'.
%%
%% This work consists of all files listed in README
%%
\ExplSyntaxOn
  % Add \centering, approperiate line breaks, and define some important lengths, for listing environments and input listings. 
    \NewDocumentCommand{\ModifiedNewTCBInputListing}{ O{} m m m }{
      \NewTCBInputListing[ #1 ]{ #2 }{ #3 }{ #4 }
      \AddToHook{cmd/\cs_to_str:N #1/before}{
        % Before \tcbinputlisting
            % The value of \linewidth where the corresponding listing environment is located
              % The name is \linewidth*outside* precisely because its the \linewidth (immediately) outside the listing environment
              \dim_set:Nn \g__listings_autowidth@core_max_tcb_width_dim {\the\linewidth}%
          % Centering the \tcbinputlisting
          \par%
          \begingroup%
            \centering%
      }
      \AddToHook{cmd/\cs_to_str:N #1/after}{
        % After \tcbinputlisting
            \__listings_autowidth_lower_savewidth:%
            \__listings_debug_autowidth:%
            \stepcounter{code}%
          \endgroup%
      }
    }
\ExplSyntaxOff