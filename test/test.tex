\ExplSyntaxOn
\AtEndDocument { \benchmark_toc: }
\benchmark_tic:
\ExplSyntaxOff
\documentclass[11pt, titlepage, a4paper, oneside]{book}
\input{../preamble/preamble}
\usepackage{datetime2}

\renewcommand{\FancyVerbFormatLine}[1]{\eqsavebox{\codewidth}[codeupperwidth\arabic{code}]{#1}\fbox{#1}}

\usepackage{showframe}

\newcounter{codeinput}
\newwrite\tmptextfile
\NewDocumentEnvironment{codeinput}{ O{} m c }{
    \stepcounter{codeinput}%
    \def\tmpfilename{\jobname\arabic{codeinput}.txt}%
    \immediate\openout\tmptextfile=\tmpfilename%
    \def\obeyedline{^^J}
    \immediate\write\tmptextfile{#3}%
    \immediate\closeout\tmptextfile%
    \inputcode*[#1]{\tmpfilename}
}{}

\begin{document}
\section*{Last successful compile: \DTMnow}

This file is a compilation of various uses of the listing boxes generated with \codeinline{TeX}{\ModifiedNewTCBListing} and \codeinline{TeX}{\ModifiedNewTCBInputListing}. In this way, robustness checks are performed to ensure they function correctly---as bug-free as possible.
\begin{code*}[debug=autowidth]{Text}
    Hello
\end{code*}
\chapter{ModifiedNewTCBListing}
\input{test_ModifiedNewTCBListing.tex}
\begin{code*}[autowidth = upper, debug = autowidth]{Text}
    test
\end{code*}

\chapter{ModifiedNewTCBInputListing}
\RenewDocumentEnvironment{code*}{ O{} m c }{
    \stepcounter{codeinput}%
    \def\tmpfilename{\jobname\arabic{codeinput}.txt}%
    \immediate\openout\tmptextfile=\tmpfilename%
    \def\obeyedline{^^J}
    \immediate\write\tmptextfile{#3}%
    \immediate\closeout\tmptextfile%
    \inputcode*[#1]{\tmpfilename}
}{}
\input{test_ModifiedNewTCBListing.tex}



\end{document}