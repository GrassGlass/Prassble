% Source - https://tex.stackexchange.com/a/755401
% Posted by cfr, modified by community. See post 'Timeline' for change history
% Retrieved 2026-02-14, License - CC BY-SA 4.0

\documentclass[border=10pt,multi,tikz]{standalone}
% ateb: https://tex.stackexchange.com/a/754955/
% ateb: https://tex.stackexchange.com/a/755401/
\usepackage[edges]{forest}
\usetikzlibrary{calc}
\definecolor{folderbg}{RGB}{124,166,198}
\definecolor{folderborder}{RGB}{110,144,169}
\newlength\Size
\setlength\Size{4pt}
\tikzset{%
  folder/.pic={%
    \draw [draw=folderborder, sharp corners, top color=folderbg!50, bottom color=folderbg
    ] (-1.05*\Size,0.2\Size+5pt) rectangle ++(.75*\Size,-0.2\Size-5pt);
    \draw [draw=folderborder, sharp corners, top color=folderbg!50, bottom color=folderbg
    ] (-1.15*\Size,-\Size) rectangle (1.15*\Size,\Size);
  },
  file/.pic={%
    \filldraw [draw=folderborder, sharp corners, top color=folderbg!5, bottom color=folderbg!10] (-\Size,.4*\Size+5pt) coordinate (a) |- (\Size,-1.2*\Size) coordinate (b) -- ++(0,1.6*\Size) coordinate (c) -- ++(-5pt,5pt) coordinate (d) -- cycle (d) |- (c) ;
  },
}
\forestset{%
  declare autowrapped toks={pic me}{},
  declare boolean register={pic root},
  pic root=0,
  declare keylist={additional edge options}{},
  pic dir tree/.style={%
    for tree={%
      folder,
      font=\ttfamily,
      grow'=0,
    },
    before typesetting nodes={%
      for tree={%
        edge label+/.option={pic me},
      },
      if pic root={
        tikz+={
          \pic at ([xshift=\Size].west) {folder};
        },
        align={l}
      }{},
    },
  },
  pic me set/.code n args=2{%
    \forestset{%
      #1/.style={%
        inner xsep=2\Size,
        pic me={pic {#2}},
      }
    }
  },
  pic me set={directory}{folder},
  pic me set={file}{file},
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%===========================================%
\makeatletter
\def\dirtree@dot@radius{0.5pt}
\def\dirtree@vdots@length{10pt}
\forestset{%
  declare toks={real siblings}{},
  continue/.style={%
    delay={%
      if n children=0{%
        before computing xy={%
          for current and following siblings={%
            s'+=-10pt,
          },
        },
        if n=1{%
          edge path'={%
            (!u.parent anchor) ++(\foresteregister{folder indent},0pt)
            coordinate (a) --
            ($(!u.parent anchor -| a)!1/3!(.child anchor -| a)$)
            edge [dotted]  
            ($(!u.parent anchor -| a)!2/3!(.child anchor -| a)$)
            ($(!u.parent anchor -| a)!2/3!(.child anchor -| a)$)
            |- (.child anchor)
          },
        }{%
          edge path'={%
            (!u.parent anchor |- !p.child anchor) 
            ++(\foresteregister{folder indent},0pt)
            coordinate (a) --
            ($(!p.child anchor -| a)!1/3!(.child anchor -| a)$)
            edge [dotted]  
            ($(!p.child anchor -| a)!2/3!(.child anchor -| a)$)
            ($(!p.child anchor -| a)!2/3!(.child anchor -| a)$)
            |- (.child anchor)
          },
        },
        for following siblings={%
          edge path'={%
            (!u.parent anchor |- !p.child anchor) 
            ++(\foresteregister{folder indent},0pt) |-
            (.child anchor)
          },
        },
      }{%
        prepend={[\strut,
            delay={%
              do dynamics,
              temptoksa=,
              for following siblings={%
                if temptoksa={}{}{%
                  temptoksa+={,},
                },
                temptoksa+/.option=name,
              },
              real siblings/.register=temptoksa,
              folder,
              grow'=0,
              before computing xy={%
                l'=0pt,
                s'=-\dirtree@vdots@length, % length of vdots
              },
              delay n=2{%
                split option={real siblings}{,}{append},
              },
              before typesetting nodes={%
                temptoksa/.option=name,
                delay={
                  do dynamics,
                  for children={
                    if n=1{
                      edge path'={%
                        (!uu.parent anchor) ++(\foresteregister{folder indent},0pt)
                        coordinate (a) --
                        ($($(a)!1/2!(.child anchor -| a)$)+0.5*(0,\dirtree@vdots@length)$) coordinate (A\foresteoption{id})
                        %
                        ($($(a)!1/2!(.child anchor -| a)$)-0.5*(0,\dirtree@vdots@length)$) coordinate (B\foresteoption{id}) |-  (.child anchor)%
                      },
                      tikz+={
                        \coordinate (A') at ($(A\foresteoption{id})+(0,\dirtree@dot@radius)$);
                        \coordinate (B') at ($(B\foresteoption{id})-(0,\dirtree@dot@radius)$);
                        \coordinate (C) at ($0.25*($(B')-(A')$)$);
                        \fill ($(A')+(C)$) circle (\dirtree@dot@radius);
                        \fill ($(A')+2*(C)$) circle (\dirtree@dot@radius);
                        \fill ($(A')+3*(C)$) circle (\dirtree@dot@radius);
                      },
                    }{
                      edge path'={%
                        (!uu.parent anchor) ++(\foresteregister{folder indent},0pt)
                        coordinate (a) 
                        (a |- !p.child anchor) |- (.child anchor)
                      },
                    },
                  },
                },
              },
            },
            no edge,
        ]},
      },
    },
  },
  to be continued/.style={%
    delay={%
      append={[\strut,
        folder,
        grow'=0,
        before computing xy={%
          l'=0pt,
          s'=0pt,
        },
        if n children=0{%
          before drawing tree={%
            delay={%
              y/.min={>O{y}}{parent,descendants},
            },
          },
        }{},
        edge path'={%
          (!uu.parent anchor |- !u.child anchor) 
          ++(\foresteregister{folder indent},0pt)
          coordinate (a) --
          (.parent anchor -| a) coordinate (A\foresteoption{id})
          %
          ([yshift=-\dirtree@vdots@length]% length of vdots
          A\foresteoption{id}) coordinate (B\foresteoption{id})     
        },
        tikz+={
          \coordinate (A') at ($(A\foresteoption{id})+(0,\dirtree@dot@radius)$);
          \coordinate (B') at ($(B\foresteoption{id})-(0,\dirtree@dot@radius)$);
          \coordinate (C) at ($0.25*($(B')-(A')$)$);
          \fill ($(A')+(C)$) circle (\dirtree@dot@radius);
          \fill ($(A')+2*(C)$) circle (\dirtree@dot@radius);
          \fill ($(A')+3*(C)$) circle (\dirtree@dot@radius);
        },
      ]},
    },
  },
}
\makeatother
%===========================================%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\begin{forest}
  pic dir tree,
  pic root,
  for tree={% folder icons by default; override using file for file icons
    directory,
    s sep=1cm,
    l sep=1cm
  },
  [system
    [config
    ]
    [lib
      [file.txt, file
      ]
    ]
  ]
\end{forest}
\begin{forest}
  pic dir tree,
  pic root,
  for tree={% folder icons by default; override using file for file icons
    directory,
    s sep=1cm,
    l sep=1cm
  },
  [system, continue
    [config
    ]
    [lib, to be continued
      [file.txt, file, to be continued
      ]
    ]
  ]
\end{forest}
\end{document}
