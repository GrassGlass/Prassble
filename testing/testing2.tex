\documentclass[11pt, a4paper]{book}
\usepackage{eqparbox}
\usepackage[skins, breakable, minted]{tcolorbox}

% Counters
    \newcounter{code}
    \setcounter{code}{1}

% Lengths
    \newlength{\BorderlineWestThickness}
    \newlength{\boxsep}
    \newlength{\boxrule}
    \newlength{\numbersep}
    \newlength{\linenumberpadding}
    \newlength{\lefthspace}

    \setlength{\BorderlineWestThickness}{2pt}
    \setlength{\boxsep}{1pt}
    \setlength{\boxrule}{0pt}
    \setlength{\numbersep}{10pt}
    \setlength{\linenumberpadding}{8.6pt}
    \setlength{\lefthspace}{8.5pt}

\makeatletter
\ExplSyntaxOn
  \dim_new:N \g__listings_Leftupper_dim
  \cs_new:Npn \__listings_codestylecore@borderlinewest: {
      \fill[black] (frame.south~west)
      rectangle ([xshift=\BorderlineWestThickness]frame.north~west);}

  \tcbset{
    ,Leftupper/.code = {
        \dim_set:Nn \g__listings_Leftupper_dim {-\kvtcb@left@rule+\kvtcb@leftupper+\kvtcb@boxsep+(\linenumberpadding+\BorderlineWestThickness)/2} % 4mm is the initial leftupper
        \pgfkeysalso{
        leftupper = \g__listings_Leftupper_dim
        }
    }
    ,codestylebase/.style =
    {
        ,Leftupper
        ,listing~engine                  = minted
        ,minted~options                  = 
        {
          ,breaklines
          ,autogobble
          ,linenos
          ,numbersep = \numbersep
        }
        ,listing~only
        ,breakable
        ,enhanced
        ,skin                            = enhanced~jigsaw
        ,boxsep                          = \boxsep
        ,boxrule                         = \boxrule
        ,colback                         = black!10 
        ,borderline~west                 = {\BorderlineWestThickness}{0pt}{black}
        ,overlay~unbroken                = {
        % Background for the code line numbers
            % Case 1: The current (partial) box contains only an upper part.
            \int_compare:nNnT {\tcbsegmentstate}={0} {
            \filldraw[black!20] 
            (frame.south~west) --
            (interior.north~west) {[rounded~corners=4] --
            ++(\eqboxwidth{code\arabic{code}}+\linenumberpadding,0) --
            ([xshift=\eqboxwidth{code\arabic{code}}+\linenumberpadding]frame.south~west)} --
            (frame.south~west);
            }
            % Case 2: The current (partial) box contains an upper and a lower part. The segmentation node can be used for positioning.
            \int_compare:nNnT {\tcbsegmentstate}={1} {
            \filldraw[black!20] 
            (segmentation.west) --
            (interior.north~west) {[rounded~corners=4] --
            ++(\eqboxwidth{code\arabic{code}}+\linenumberpadding,0) --
            ([xshift=\eqboxwidth{code\arabic{code}}+\linenumberpadding]segmentation.west)} --
            (segmentation.west);
            }
        % Borderline west of \BorderlineWestThickness thickness
        \__listings_codestylecore@borderlinewest:
        }
        ,overlay~first                   = {
        % Background for the code line numbers
        \filldraw[black!20] 
        (frame.south~west) --
        (interior.north~west) {[rounded~corners=4] --
        ++(\eqboxwidth{code\arabic{code}}+\linenumberpadding,0)} --
        ([xshift=\eqboxwidth{code\arabic{code}}+\linenumberpadding]frame.south~west) --
        (frame.south~west);
        % Borderline west of \BorderlineWestThickness thickness
        \__listings_codestylecore@borderlinewest:
        }
        ,overlay~middle                  = {
        % Background for the code line numbers
        \fill[black!20] (frame.south~west)
        rectangle ([xshift=\eqboxwidth{code\arabic{code}}+\linenumberpadding]frame.north~west);
        % Borderline west of \BorderlineWestThickness thickness
        \__listings_codestylecore@borderlinewest:
        }
        ,overlay~last                    = {
        % Background for the code line numbers
            % Case 1: The current (partial) box contains only an upper part.
            \int_compare:nNnT {\tcbsegmentstate}={0} {
            \filldraw[black!20] 
            (frame.south~west) --
            (frame.north~west) --
            ++(\eqboxwidth{code\arabic{code}}+\linenumberpadding,0) {[rounded~corners=4] --
            ([xshift=\eqboxwidth{code\arabic{code}}+\linenumberpadding]frame.south~west)} --
            (frame.south~west);
            }
            % Case 2: The current (partial) box contains an upper and a lower part. The segmentation node can be used for positioning.
            \int_compare:nNnT {\tcbsegmentstate}={1} {
            \filldraw[black!20] 
            (segmentation.west) --
            (frame.north~west) --
            ++(\eqboxwidth{code\arabic{code}}+\linenumberpadding,0) {[rounded~corners=4] --
            ([xshift=\eqboxwidth{code\arabic{code}}+\linenumberpadding]segmentation.west)} --
            (segmentation.west);
            }
        % Borderline west of \BorderlineWestThickness thickness
        \__listings_codestylecore@borderlinewest:
        }
    }
  }
\ExplSyntaxOff
\makeatother

\newtcblisting{code}[1]{
    ,codestylebase
    ,minted language = Text
}

% framebox and red line numbers for debugging
\renewcommand{\theFancyVerbLine}{%
                \eqframebox[code\arabic{code}][c]{%
                    \textcolor{red}{\scriptsize\arabic{FancyVerbLine}}%
                }%
            }

\begin{document}
\begin{code}{Julia}
    ~



    ~
\end{code}
\end{document}