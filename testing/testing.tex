\documentclass{book}
\usepackage[T1]{fontenc}
\usepackage{filetree}
\usepackage{showframe}

\ExplSyntaxOn
\cs_new:Npn \__filetree_remaining_height_on_page_use: {
  \dim_compare:nNnTF { \pagegoal } = { \maxdimen }
    { \dim_eval:n { \textheight } }
    { \dim_eval:n { \pagegoal - \pagetotal } }
}

\NewDocumentCommand{\RemainingHeight}{ }{
  \__filetree_remaining_height_on_page_use:
}
\ExplSyntaxOff

\begin{document}
\ExplSyntaxOn
\iow_new:N \g__filetree_heights_iow
\int_new:N \l__filetree_object_number_int
\seq_new:N \l__filetree_heights_seq
\NewDocumentCommand{\SaveHeight}{ m }{
  \seq_gput_right:Ne \l__filetree_heights_seq { \dim_to_decimal:n { #1 } }
}
\ExplSyntaxOff
\forestset{
  ,file tree/.append style={for tree={l sep=0.8cm}}
}

\usetikzlibrary{fpu}
\newcommand{\pgfmathparseFPU}[1]{\begingroup%
\pgfkeys{/pgf/fpu=true,/pgf/fpu/output format=fixed}%
\pgfmathparse{#1}%
\pgfmathsmuggle\pgfmathresult\endgroup}
\makeatletter
\pgfmathdeclarefunction{distance}{2}{%
\begingroup%
\pgfextractx{\pgf@xa}{\pgfpointanchor{#1}{center}}%
\pgfextracty{\pgf@ya}{\pgfpointanchor{#1}{center}}%
\pgfextractx{\pgf@xb}{\pgfpointanchor{#2}{center}}%
\pgfextracty{\pgf@yb}{\pgfpointanchor{#2}{center}}%
\pgfmathparseFPU{sqrt((\pgf@xa-\pgf@xb)*(\pgf@xa-\pgf@xb)+(\pgf@ya-\pgf@yb)*(\pgf@ya-\pgf@yb))}%
\pgfmathsmuggle\pgfmathresult\endgroup%
}%
\makeatother
\makeatletter
\def\dirtree@dot@radius{1pt}
\forestset{%
  declare toks={real siblings}{},
  vdots@root/.style={%
    delay={%
      if n children=0{%
        before computing xy={%
          for current and following siblings={%
            s'+=-10pt,
          },
        },
        if n=1{%
          edge path'={%
            (!u.parent anchor) ++(\foresteregister{folder indent},0pt)
            coordinate (a) --
            ($(!u.parent anchor -| a)!1/3!(.child anchor -| a)$)
            edge [dotted]  
            ($(!u.parent anchor -| a)!2/3!(.child anchor -| a)$)
            ($(!u.parent anchor -| a)!2/3!(.child anchor -| a)$)
            |- (.child anchor)
          },
        }{%
          edge path'={%
            (!u.parent anchor |- !p.child anchor) 
            ++(\foresteregister{folder indent},0pt)
            coordinate (a) --
            ($(!p.child anchor -| a)!1/3!(.child anchor -| a)$)
            edge [dotted]  
            ($(!p.child anchor -| a)!2/3!(.child anchor -| a)$)
            ($(!p.child anchor -| a)!2/3!(.child anchor -| a)$)
            |- (.child anchor)
          },
        },
        for following siblings={%
          edge path'={%
            (!u.parent anchor |- !p.child anchor) 
            ++(\foresteregister{folder indent},0pt) |-
            (.child anchor)
          },
        },
      }{%
        prepend={[\strut,
            delay={%
              do dynamics,
              temptoksa=,
              for following siblings={%
                if temptoksa={}{}{%
                  temptoksa+={,},
                },
                temptoksa+/.option=name,
              },
              real siblings/.register=temptoksa,
              folder,
              grow'=0,
              before computing xy={%
                l'=0pt,
                s'=-15pt,
              },
              delay n=2{%
                split option={real siblings}{,}{append},
              },
              before typesetting nodes={%
                temptoksa/.option=name,
                delay={
                  do dynamics,
                  for children={
                    if n=1{
                      edge path'={%
                        (!uu.parent anchor) ++(\foresteregister{folder indent},0pt)
                        coordinate (a) --
                        ($(a)!1/3!(.child anchor -| a)$) coordinate (A)        
                        %
                        ($(a)!2/3!(.child anchor -| a)$)  coordinate (B)
                        %
                        ($(a)!2/3!(.child anchor -| a)$)
                        |-  (.child anchor)%
                      },
                      tikz+={
                        \coordinate (A') at ($(A)+(0,\dirtree@dot@radius)$);
                        \coordinate (B') at ($(B)-(0,\dirtree@dot@radius)$);
                        \coordinate (C) at ($0.25*($(B')-(A')$)$);
                        % Debugging
                          % \draw[blue] ($(A')-(5pt,0)$) -- ($(A')+(5pt,0)$);
                          % \draw[red] ($(A')+(C)-(5pt,0)$) -- ($(A')+(C)+(5pt,0)$);
                          % \draw[red] ($(A')+2*(C)-(5pt,0)$) -- ($(A')+2*(C)+(5pt,0)$);
                          % \draw[red] ($(A')+3*(C)-(5pt,0)$) -- ($(A')+3*(C)+(5pt,0)$);
                          % \draw[red] ($(A')+4*(C)-(5pt,0)$) -- ($(A')+4*(C)+(5pt,0)$);
                          % \draw[blue] ($(B')-(5pt,0)$) -- ($(B')+(5pt,0)$);
                        \fill ($(A')+(C)$) circle (\dirtree@dot@radius);
                        \fill ($(A')+2*(C)$) circle (\dirtree@dot@radius);
                        \fill ($(A')+3*(C)$) circle (\dirtree@dot@radius);
                      },
                    }{
                      edge path'={%
                        (!uu.parent anchor) ++(\foresteregister{folder indent},0pt)
                        coordinate (a) 
                        (a |- !p.child anchor) |- (.child anchor)
                      },
                    },
                  },
                },
              },
            },
            no edge,
        ]},
      },
    },
  },
  vdots@others/.style={%
    delay={%
      append={[\strut,
        folder,
        grow'=0,
        before computing xy={%
          l'=0pt,
          s'=-15pt,
        },
        if n children=0{%
          before drawing tree={%
            delay={%
              y/.min={>O{y}}{parent,descendants},
            },
          },
        }{},
        edge path'={%
          ([xshift=\forestregister{folder indent}]!uu.parent anchor) 
          coordinate (a) --
          ([yshift=9pt].parent anchor -| a) coordinate (A)
          %
          (.parent anchor -| a) coordinate (B)
        },
        tikz+={
          \coordinate (A') at ($(A)+(0,\dirtree@dot@radius)$);
          \coordinate (B') at ($(B)-(0,\dirtree@dot@radius)$);
          \coordinate (C) at ($0.25*($(B')-(A')$)$);
          \fill ($(A')+(C)$) circle (\dirtree@dot@radius);
          \fill ($(A')+2*(C)$) circle (\dirtree@dot@radius);
          \fill ($(A')+3*(C)$) circle (\dirtree@dot@radius);
        },
      ]},
    },
  },
  vdots/.style={
    if level = 0{vdots@root}{vdots@others}
  }
}
\makeatother
\begin{forest}
 file tree
 ,tikz+={
  % The bounding box of the forest environment
    \draw[line width=0.07pt] (current bounding box.north west) -- (current bounding box.north east) -- (current bounding box.south east) -- (current bounding box.south west) -- cycle;
    % \path let \p1=($(current bounding box.north)-(current bounding box.south)$) in (current bounding box.east) node[right] {\y1\SaveHeight{\y1}};
  }
 ,for tree={
    ,tikz+={
      \draw[line width=0.07pt] (\forestoption{name}.north west) -- (\forestoption{name}.north east) -- (\forestoption{name}.south east) -- (\forestoption{name}.south west) -- cycle;
      % \node[anchor=west] at (\forestoption{name}.east) {\forestoption{name}};
      \path let \p1=($(current bounding box.north)-(\forestoption{name}.south)$) in (\forestoption{name}.east) node[below right] {\y1\SaveHeight{\y1}};
    }
  }
  [{tree}, vdots
    [{\$\&\#{\textbackslash} {\textbar}\_*{\textasciicircum}\@\%{\textlangle}{\textrangle}\{\}\textasciitilde\(+\)-\(=\):;"'`!?.}, file]
    [{FileTrees\_IncludeThis}]
    [{a\_file\_with\_[}, file, tikz+={\gdef\foo{Nope}}]
    [{a\_file\_with\_]}, file, tikz+={\gdef\foo{Code is executed in sequential order of nodes.}}]
    [{a\_file\_with\_][\_[\_]\_[[[}, file]
    [{a\_file\_with\_\{}, file]
    [{a\_file\_with\_\}}, file]
    [{a\_file\_with\_\}\{\_\{\_\}\_\{\{\{}, file]
    [{a\_folder\_with\_'\_and\_"\_yes}, file]
    [{another\_folder}]
    [{basename}, file]
    [{bash.pdf}, file]
    [{bash.tex}, file]
    [{bash\_test.tex}, file]
    [{folder}]
    [{hello.sh}, file]
    [{include\_this}
      [{folder1}]
      [{include\_this.tex}, file]
    ]
    [{some\_folder}
      [{tmp.tex}, file, vdots]
    ]
  ]
  \xdef\ssep{\foresteoption{s sep}}
\end{forest}\par
\meaning\foo\par
\fbox{\texttt{s sep}: \ssep}\par
\ExplSyntaxOn
\fbox{ \seq_use:Nn \l__filetree_heights_seq {,} }\par

\str_new:N \l__filetree_total_heights_perl_array_str
\str_set:Ne \l__filetree_total_heights_perl_array_str {
  \seq_use:Nn \l__filetree_heights_seq {, ~}
}
\str_put_left:Ne \l__filetree_total_heights_perl_array_str { \c_space_tl \c_space_tl \c_space_tl \c_space_tl }

\iow_open:Nn \g__filetree_heights_iow { height.pl }
\iow_now:Ne \g__filetree_heights_iow { \c_hash_str !/usr/bin/perl }
\iow_now:Ne \g__filetree_heights_iow { 
  my~
  \c_dollar_str remaining \c_underscore_str height~ =~ \dim_to_decimal:n { \__filetree_remaining_height_on_page_use: }; 
  \iow_newline:
  my ~ \c_atsign_str total_height ~ = ~ (
    \iow_newline:
    \str_use:N \l__filetree_total_heights_perl_array_str
    \iow_newline:
  );
}
\iow_close:N \g__filetree_heights_iow
\ExplSyntaxOff
\fbox{Remaining space on page: \RemainingHeight}
\par
\renewcommand{\fboxsep}{0pt}
\fbox{\parbox[c][\RemainingHeight]{2cm}{}}
\newpage
\RemainingHeight\par
\fbox{\parbox[c][\RemainingHeight]{2cm}{}}
\end{document}
